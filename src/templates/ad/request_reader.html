{% extends 'ad/base.html' %}
{% load my_tags %}
{% block Page_content %}

<style>
    a {
      text-decoration:none;
      color: black;
      font-weight: 500;
    }
</style>
<section class="py-4">
<div class="container">
    <h3 class="fw-bolder text-center">Request Reader Account</h3>
    <center>
    <hr class="bg-primary opacity-100" style="height:3px" width="5%" />
    </center>
    <div class="card rounded-0 shadow">
    <div class="card-body">
        <div class="container-fluid">
            <div class="d-flex justify-content-between">
                <div class="mb-3">
                  <a href="{% url 'reader_info' 'id'%}" class="btn btn-sm btn-warning rounded-1 bg-gradient-primary" type="button"><i class="fa-solid fa-arrow-rotate-left"></i> Back</a>
                </div>
                <div class="mb-3">
                    <button class="btn btn-sm btn-success rounded-1 bg-gradient-primary" data-bs-toggle="modal" data-bs-target="#modal"><i class="fa fa-plus"></i> Add New</button>
                </div>
              </div>
            <!-- input search + reset button-->
            <div class="input-group input-group-sm mb-3">
                <input type="text" onkeyup="searchFunction()" class="form-control" id="search" placeholder="Search for...">
                <a href="" class="btn btn-dark"><i class="fas fa-sync-alt"></i></a>  
            </div>
            <table class="table table-bordered table-sm-mt-4"  style="text-align: center;">
                <colcategory>
                <col width="5%"  />
                <col width="25%" />
                <col width="20%" />
                <col width="25%" />
                <col width="15%" />
                <col width="10%" />
                </colcategory>
                <thead class="table-info">
                <tr id="chk-th">
                    <th class="text-center" scope="col">#</th>
                    <th class="text-center" scope="col"><a href="{% url 'request_reader' 'first_name'%}">First Name <i class="fa-solid fa-sort"></i></a></th>
                    <th class="text-center" scope="col"><a href="{% url 'request_reader' 'last_name'%}">Last Name <i class="fa-solid fa-sort"></i></a></th>
                    <th class="text-center" scope="col"><a href="{% url 'request_reader' 'email'%}">Email <i class="fa-solid fa-sort"></i></a></th>
                    <th class="text-center" scope="col"><a href="{% url 'request_reader' 'status'%}">Status <i class="fa-solid fa-sort"></i></a></th>
                    <th class="text-center" class="text-center">Action</th>
                </tr>
                </thead>
                <tbody id="myTable">
                {% if requests %}
                    {% for r in requests %}
                    <tr>
                        <td class="text-center" scope="row">{{ forloop.counter }}</td>
                        <td class="text-center">{{ r.first_name }}</td>
                        <td class="text-center">{{ r.last_name }}</td>
                        <td class="text-center">{{ r.email}}</td>
                        <td class="text-center">
                        {% if r.status == "1"%}
                            Wait
                        {% endif %}
                        {% if r.status == "2"%}
                            Accept
                        {% endif %}
                        {% if r.status == "3"%}
                            Decline
                        {% endif %}
                        </td>
                        <td class="text-center">
                        <div class="dropdown">
                            <button class="btn btn-light btn-sm rounded-0 border dropdown-toggle" type="button" id="{{ r.pk }}" data-bs-toggle="dropdown" aria-expanded="false">Action</button>
                            <ul class="dropdown-menu" aria-labelledby="{{ r.pk }}">
                            <li>
                                <a class="dropdown-item" href="{% url 'delete_request_reader' r.pk %}"><i class="fa fa-trash text-danger"></i> Delete</a>
                            </li>
                            </ul>
                        </div>
                        </td>
                    </tr>
                    {% endfor %}
                {% endif %}
                </tbody>
            </table>
        <div class="d-flex justify-content-center">
        <span class="text-danger" id="no-data" style="font-size: 20px;"></span>
        </div>
        <nav aria-label="Page">
            <ul class="pagination  justify-content-end">
                {% if requests.has_previous %}
                <li class="page-item"><a class="page-link" href="?page={{requests.previous_page_number}}"><i class="fa-solid fa-backward"></i></a></li>
                {% else %}
                <li class="page-item disabled"><a class="page-link"><i class="fa-solid fa-backward"></i></a></li>
                {% endif %}

                {% if requests.number|moreB%}
                <li class="page-item"><a class="page-link" style="pointer-events: none;"><i class="fa-solid fa-ellipsis"></i></a></li>
                {% endif %}

                {% for i in requests.number|range_list:requests.paginator.num_pages %}
                {% if i == requests.number %}
                <li class="page-item"><a class="page-link" href="?page={{i}}" style="background-color: #d3d3d3;">{{i}}</a></li>
                {% else %}
                <li class="page-item"><a class="page-link" href="?page={{i}}">{{i}}</a></li>
                {% endif %}

                {% endfor %}

                {% if requests.number|moreF:requests.paginator.num_pages%}
                <li class="page-item"><a class="page-link" style="pointer-events: none;"><i class="fa-solid fa-ellipsis"></i></a></li>
                {% endif %}

                {% if requests.has_next %}
                <li class="page-item"><a class="page-link" href="?page={{requests.next_page_number}}"><i class="fa-solid fa-forward"></i></a></li>
                {% else %}
                <li class="page-item disabled"><a class="page-link"><i class="fa-solid fa-forward"></i></a></li>
                {% endif %}
            </ul>
        </nav>
        </div>
        </div>
        </div>
    </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="modal" tabindex="-1" aria-labelledby="modal" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
        <div class="modal-header">
            <i class="fa fa-plus text-success"> Request Reader Account</i>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
        <form action="" method = "POST" autocomplete="off" class = "card p-3 mt-1 border-dark was-validated">
            {% csrf_token %}
            <div class="input-group mb-3 mt-3">
                <span class="input-group-text border-dark" style="width: 102px;">First Name</span>
                <input type="text" id="first_name" name="first_name" class="form-control" placeholder="First Name" required>
            </div>
            <div class="input-group mb-3 mt-3">
                <span class="input-group-text border-dark"style="width: 102px;">Last Name</span>
                <input type="text" id="last_name" name="last_name" class="form-control" placeholder="Last Name" required>
            </div>
            <div class="input-group mb-3 mt-3">
                <span class="input-group-text border-dark" style="width: 102px;">Email</span>
                <input type="text" id="email" name="email" class="form-control" placeholder="Email" required>
            </div>
            <div class="text-end mt-3">
                <input class="btn btn-danger" type="submit" value="Request">
            </div>
        </form>
        </div>
        </div>
    </div>
</div>
</section>
{% endblock Page_content %}

        